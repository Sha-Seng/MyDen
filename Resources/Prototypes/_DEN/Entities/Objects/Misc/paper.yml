# SPDX-FileCopyrightText: 2025 Rosycup <178287475+Rosycup@users.noreply.github.com>
# SPDX-FileCopyrightText: 2025 Rosycup <***>
# SPDX-FileCopyrightText: 2025 sleepyyapril <123355664+sleepyyapril@users.noreply.github.com>
#
# SPDX-License-Identifier: AGPL-3.0-or-later AND MIT

- type: entity
  name: ce's fountain pen
  parent: PenEmbeddable
  id: PenCe
  description: 'A luxurious fountain pen for the chief engineer of the station. Has anti-static grips.'
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_ce

- type: entity
  name: hos' fountain pen
  parent: PenEmbeddable
  id: PenHos
  description: 'A luxurious fountain pen for the head of security of the station. Sharper than normal pens.'
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_hos
  - type: DamageOtherOnHit
    damage:
      types:
        Piercing: 8

- type: entity
  name: lo's fountain pen
  parent: PenEmbeddable
  id: PenLo
  description: 'A luxurious fountain pen for the logistics officer of the station. Smells like bounties to be written.'
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_lo

- type: entity
  name: mystagogue's fountain pen
  parent: PenEmbeddable
  id: PenRd
  description: 'A luxurious fountain pen for the mystagogue of the station. More explosive resistant than normal pens.'
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_rd

- type: entity
  name: blueshield's fountain pen
  parent: PenEmbeddable
  id: PenBlueshield
  description: 'A luxurious fountain pen for the blueshield officer of the station. It has scuff marks and battle damage but still does its duty.'
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_bso
  - type: DamageOtherOnHit
    damage:
      types:
        Piercing: 8

- type: entity
  id: BoxFolderFireproof
  parent: [ BoxFolderBase, ContentsExplosionResistanceBase, ContentsIgnitionPreventionBase ]
  name: fireproof folder
  description: A folder made to resist the dangers of fire and explosions.
  components:
  - type: ExplosionResistance
    damageCoefficient: 0
  - type: Sprite
    sprite: Objects/Misc/bureaucracy.rsi
    layers:
    - state: folder-fireproof
    - state: folder-base

- type: entity
  id: BoxFolderAA
  parent: BoxFolderFireproof
  name: administrative assistant's compact folder
  description: The pinnacle of bureaucratic innovation, implementing bluespace tech to assist the station's strongest pen warrior in their paperwork endeavors. Holster for a pen included!
  components:
  - type: Item
    sprite: Objects/Misc/bureaucracy.rsi
    size: Tiny
    shape: null
  - type: Storage
    maxItemSize: Small
    grid:
    - 0,0,14,4
    whitelist:
      tags:
      - Document
  - type: Sprite
    sprite: Objects/Misc/bureaucracy.rsi
    layers:
    - state: folder-aa
    - state: folder-base
  - type: ContainerContainer
    containers:
      storagebase: !type:Container
        ents: [ ]
      pen_slot: !type:ContainerSlot { }
  - type: ItemSlots
    slots:
      pen_slot:
        name: folder-slot-component-slot-name-pen
        whitelist:
          tags:
          - Write
  - type: ItemMapper
    mapLayers:
      folder-overlay-paper:
        whitelist:
          tags:
          - Document
      folder-aa-overlay-pen:
        whitelist:
          tags:
          - Write

- type: entity
  parent: BoxFolderFireproof
  id: BoxFolderMantis
  name: mantis ledger
  description: "A foreboding folder designed to document the station's psychics. Fireproof, immune to scrying, and carrying a special pen."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    layers:
    - state: folder-mantis
    - state: folder-base-mantis
  - type: Item
    heldPrefix: folder-mantis
  - type: ContainerContainer
    containers:
      storagebase: !type:Container
        ents: [ ]
      pen_slot: !type:ContainerSlot { PenMantis }
  - type: ItemSlots
    slots:
      pen_slot:
        name: folder-slot-component-slot-name-pen
        whitelist:
          tags:
          - Write
  - type: ItemMapper
    mapLayers:
      folder-overlay-paper-mantis:
        whitelist:
          tags:
          - Document
      folder-mantis-overlay-pen:
        whitelist:
          tags:
          - Write
  - type: Storage
    maxItemSize: Small
    whitelist:
      tags:
        - Document
        - MantisFolderEquip # Only the pen and the stamp have this, but the pen also has its own slot on the item itself
    grid: # It's a 5x5 square with an isolated slot in the middle for the stamp
    - 0,0,4,0
    - 0,4,4,4
    - 0,1,1,1
    - 3,1,4,1
    - 0,3,1,3
    - 3,3,4,3
    - 0,2,0,2
    - 2,2,2,2
    - 4,2,4,2
  - type: StorageFill
    contents: # Contains 20 mantis papers you can use to write down names of psychics, or warnings, or psychic therapy notes or whatever, with the stamp in the center
      - id: PaperMantis
        amount: 10
      - id: RubberStampMantis
      - id: PaperMantis
        amount: 10

- type: entity
  parent: PenEmbeddable
  id: PenMantis # The most mechanically complex pen in the world, all just for style
  name: mantis stylus
  description: "A writing tool chiseled from a spike of mnemolith. Do not accidentally poke yourself with it."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Misc/bureaucracy.rsi
    state: pen_mantis
  - type: Item
    heldPrefix: pen_mantis
  - type: AntiPsionicWeapon # Same modifiers as the AntiPsychicKnife since it's made of the same material, but it does very little damage unless thrown
    punish: false
    modifiers:
      coefficients:
        Piercing: 1.25
        Holy: 1.25
  - type: DamageOtherOnHit
    damage:
      types: # Thrown damage (but you'll get it thrown back at you, and you're psychic)
        Piercing: 6.4 # 8 against psychic enemies
        Holy: 3.2 # 4 against supernatural psychic enemies (12 total)
  - type: EmbeddableProjectile
    sound: /Audio/Weapons/star_hit.ogg
    removalTime: 2
  - type: MeleeWeapon # You can swing it like a weapon since it's a crystal spike, but it's not very good
    attackRate: .6666 # Aside from damage, it has all the same melee stats (speed, range, etc.) as the AntiPsychicKnife
    range: 1.5
    heavyRateModifier: 1.25
    heavyDamageBaseModifier: 1.2
    maxTargets: 3
    angle: 40
    wideAnimationRotation: 45
    soundHit:
      path: /Audio/Weapons/bladeslice.ogg
    damage:
      types: # Melee damage (intended more for roleplay than serious combat)
        Piercing: 1.6 # 2 against psychic enemies
        Holy: 0.8 # 1 against supernatural psychic enemies (4 total)
  - type: StaminaDamageOnHit
    damage: 0
  - type: PhysicalComposition
    materialComposition:
      MaterialMnemolith1: 1
  - type: EmitSoundOnUse
    sound:
      path: /Audio/_DEN/Effects/crystaltap1.ogg
      params:
        volume: -2
        variation: 0.05
        maxDistance: 10 # Longer range to be spooky
  - type: UseDelay
    delay: 2
  - type: Tag
    tags:
      - Write
      - Pen
      - MantisFolderEquip # Only the pen and the stamp have this, but the pen also has its own slot on the item itself
  - type: InteractionVerbs
    allowedVerbs:
    - LickObject # If you really want to

- type: entity
  parent: Paper
  id: PaperMantis
  name: ledgerstone # It's a spooky pun - it comes from the mantis ledger and is made with stone powder, but a ledgerstone is a gravestone
  description: "A sharp, durable page taken from the mantis ledger. Mnemolith powder sparkles within its surface. You feel watched."
  components:
    - type: Item
      heldPrefix: paper_mantis
    - type: FlavorProfile
      flavors:
        - mantispaper
    - type: SolutionContainerManager
      solutions:
        food: # The mnemolith powder in the paper itself
          maxVol: 15
          reagents:
          - ReagentId: MnemolithReagent
            Quantity: 15 # Uncontrolled dosing, so 15 units, and you'll overdose briefly
        injector: # The mnemolith powder on the edges
          maxVol: 15
          reagents:
          - ReagentId: MnemolithReagent
            Quantity: 12
    - type: SolutionInjectOnEmbed # You get a brief extrasensory experience when it gives you a paper cut
      transferAmount: 3 # The powder on all the edges is all soaked up after four hits
      solution: injector
    - type: Extractable
      grindableSolutionName: food
    - type: PhysicalComposition
      materialComposition:
        MnemolithPowder: 1
    - type: Destructible
      thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 15
        behaviors:
        - !type:SpawnEntitiesBehavior
          spawn:
              MnemolithPowder: # Not just ash
                min: 1
                max: 1
        - !type:DoActsBehavior
          acts: [ "Destruction" ]
    - type: Flammable
      fireSpread: false
      canResistFire: false
      alwaysCombustible: true
      canExtinguish: true
      damage:
        types:
          Heat: 0.25 # Burns four times longer than a normal paper just to be scary
    - type: FireVisuals
      sprite: _DEN/Effects/fire.rsi
      normalState: mantispagefire # Has its own fire animation, also to be scary
      lightColor: "#4dc4ff"
    - type: AntiPsionicWeapon # Same modifiers as the AntiPsychicKnife since it's made with the same material, but it does almost no damage (even to psychics)
      punish: false
      modifiers:
        coefficients:
          Piercing: 1.25
          Holy: 1.25
    - type: LandAtCursor
    - type: DamageOtherOnHit
      damage:
        types: # Thrown damage (paper cut)
          Piercing: 0.8 # 1 against psychic enemies
          Holy: 0.8 # 1 against supernatural psychic enemies (2 total)
    - type: EmbeddableProjectile
      sound: /Audio/Weapons/pierce.ogg # Just a dull thunk since it does almost no damage
      removalTime: 2
    - type: Sprite
      sprite: _DEN/Objects/Misc/bureaucracy.rsi
      layers:
      - state: paper_mantis
      - state: paper_mantis_words
        map: ["enum.PaperVisualLayers.Writing"]
        visible: false
      - state: paper_stamp-generic
        map: ["enum.PaperVisualLayers.Stamp"]
        visible: false
    - type: PaperVisuals
      headerImagePath: "/Textures/_DEN/Interface/Paper/paper_background_mantis.svg.96dpi"
      headerMargin: 0.0, 0.0, 0.0, 2.0
      backgroundImagePath: "/Textures/_DEN/Interface/Paper/paper_heading_mantis.svg.96dpi"
      backgroundPatchMargin: 16.0, 16.0, 16.0, 16.0
      contentMargin: 4.0, 4.0, 4.0, 4.0
      maxWritableArea: 400.0, 400.0
